---
- name: Including per-OS trusted certificates tasks...
  when: trusted_certificates_list != []
  block:
    - name: Including Windows trusted certificates tasks for Windows systems...
      ansible.builtin.include_tasks: windows.yml
      when: ansible_system | default(false) == "Win32NT"

    - name: Including trusted certificates tasks for Unix-like systems...
      ansible.builtin.include_tasks: unix.yml
      when: ansible_system | default(false) in ['Linux', 'FreeBSD']

    - name: Including certificates tasks for MacOS systems...
      ansible.builtin.include_tasks: macos.yml
      when: ansible_system | default(false) == 'Darwin'

    - name: Including trusted certificates tasks for VyOS systems...
      ansible.builtin.include_tasks: vyos.yml
      when: ansible_network_os | default(false) == "vyos.vyos.vyos"

    - name: Including trusted certificates tasks for OPNsense and pfSense systems...
      ansible.builtin.include_tasks: sense.yml
      when: ansible_network_os | default(false) in ['opnsense', 'pfsense']

    - name: Including certificates tasks for PAN-OS systems...
      ansible.builtin.include_tasks: panos.yml
      when: ansible_network_os | default(false) == 'panos'
